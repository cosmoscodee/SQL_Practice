-- SUBQUERY PRACTICE 04

-- 문제 01

SELECT COUNT (*)
  FROM EMPLOYEES
 WHERE SALARY < (SELECT AVG (SALARY) FROM EMPLOYEES);


-- 문제 02

  SELECT EMPLOYEE_ID AS "사번",
         LAST_NAME AS "성",
         ROUND (SALARY) AS "연봉"
    FROM EMPLOYEES
   WHERE (DEPARTMENT_ID, SALARY) IN (  SELECT DEPARTMENT_ID, MAX (SALARY)
                                         FROM EMPLOYEES
                                     GROUP BY DEPARTMENT_ID)
ORDER BY SALARY DESC;


-- 문제 03

  SELECT B.JOB_TITLE AS "업무명", A.SUM_SALARY AS "연봉 총합"
    FROM (  SELECT JOB_ID, SUM (SALARY) AS "SUM_SALARY"
              FROM EMPLOYEES
          GROUP BY JOB_ID) A,
         JOBS B
   WHERE A.JOB_ID = B.JOB_ID
ORDER BY A.SUM_SALARY DESC;


-- 문제 04

SELECT A.DEPARTMENT_ID AS "사번",
       A.LAST_NAME AS "성",
       ROUND (B.AVG_SALARY) AS "자신 부서 평균 연봉",
       ROUND (A.SALARY) AS "연봉"
  FROM EMPLOYEES A,
       (  SELECT DEPARTMENT_ID, AVG (SALARY) AS AVG_SALARY
            FROM EMPLOYEES
        GROUP BY DEPARTMENT_ID) B
		
 WHERE A.DEPARTMENT_ID = B.DEPARTMENT_ID AND A.SALARY > B.AVG_SALARY;