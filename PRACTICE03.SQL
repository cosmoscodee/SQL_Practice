-- JOIN PRACTICE 03

-- 문제 01

SELECT EMP.EMPLOYEE_ID AS "사번",
       EMP.FIRST_NAME AS "사원 이름",
       DEP.DEPARTMENT_NAME AS "부서명",
       MAG.FIRST_NAME AS "매니저 이름"
  FROM EMPLOYEES EMP, DEPARTMENTS DEP, EMPLOYEES MAG
 WHERE     EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
       AND EMP.MANAGER_ID = MAG.EMPLOYEE_ID;


-- 문제 02

  SELECT REG.REGION_NAME AS "지역 이름",
         COU.COUNTRY_NAME AS "나라 이름"
    FROM REGIONS REG, COUNTRIES COU
   WHERE REG.REGION_ID = COU.REGION_ID
ORDER BY REG.REGION_NAME, COU.COUNTRY_NAME DESC;

-- 문제 03

SELECT DEP.DEPARTMENT_ID AS "부서 번호",
       DEP.DEPARTMENT_NAME AS "부서명",
       MAG.FIRST_NAME AS "매니저 이름",
       LOC.CITY AS "도시",
       COU.COUNTRY_NAME AS "나라 이름",
       REG.REGION_NAME AS "지역 이름"
  FROM DEPARTMENTS DEP,
       EMPLOYEES EMP,
       EMPLOYEES MAG,
       LOCATIONS LOC,
       COUNTRIES COU,
       REGIONS REG
 WHERE 	   EMP.MANAGER_ID = MAG.EMPLOYEE_ID
       AND DEP.LOCATION_ID = LOC.LOCATION_ID
       AND LOC.COUNTRY_ID = COU.COUNTRY_ID
       AND COU.REGION_ID = REG.REGION_ID;

-- 문제 04

SELECT JH.EMPLOYEE_ID AS "사번",
       CONCAT (EMP.FIRST_NAME, CONCAT (' ', EMP.LAST_NAME)) AS "이름"
  FROM EMPLOYEES EMP, JOB_HISTORY JH, JOBS JOB
 WHERE     JH.EMPLOYEE_ID = EMP.EMPLOYEE_ID
       AND JH.JOB_ID = JOB.JOB_ID
       AND JOB.JOB_TITLE = 'Public Accountant';

-- 문제 05

  SELECT EMPLOYEE_ID AS "사번",
         FIRST_NAME AS "이름",
         LAST_NAME AS "성",
         DEPARTMENT_NAME AS "부서 이름"
    FROM EMPLOYEES EMP, DEPARTMENTS DEP
   WHERE EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
ORDER BY EMP.LAST_NAME;

-- 문제 06

SELECT EMP.EMPLOYEE_ID, EMP.LAST_NAME, EMP.HIRE_DATE AS "채용일" --, MAG.HIRE_DATE AS "매니저 채용일"
  FROM EMPLOYEES EMP, EMPLOYEES MAG
 WHERE EMP.MANAGER_ID = MAG.EMPLOYEE_ID AND EMP.HIRE_DATE < MAG.HIRE_DATE;