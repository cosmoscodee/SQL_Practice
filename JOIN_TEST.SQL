--INNER JOIN (EQUI JOIN)

SELECT A.EMPLOYEE_ID, B.DEPARTMENT_ID, A.FIRST_NAME, B.DEPARTMENT_NAME
FROM EMPLOYEES A, DEPARTMENTS B
WHERE A.DEPARTMENT_ID = B.DEPARTMENT_ID AND A.SALARY > 5000;


--INNER JOIN (SELF JOIN, EQUI JOIN)
SELECT EMP.FIRST_NAME AS "직원 이름", MAG.FIRST_NAME AS "매니저 이름"
FROM EMPLOYEES EMP, EMPLOYEES MAG
WHERE EMP.MANAGER_ID = MAG.EMPLOYEE_ID;


--OUTER JOIN
SELECT EMP.FIRST_NAME AS "사원 이름", NVL(DEP.DEPARTMENT_NAME, '대기 발령') AS "부서 이름"
FROM EMPLOYEES EMP, DEPARTMENTS DEP
WHERE EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID(+);


SELECT EMP.FIRST_NAME AS "직원 이름", NVL(MAG.FIRST_NAME,'매니저 없음') AS "매니저 이름"
FROM EMPLOYEES EMP, EMPLOYEES MAG
WHERE EMP.MANAGER_ID = MAG.EMPLOYEE_ID(+);

SELECT * FROM EMPLOYEES WHERE MANAGER_ID IS NULL;


-- ANSI JOIN SQL (1999 SYNTAX)

-- NATURAL JOIN (TABLE들의 COLUMN이름이 동일할 경우)
SELECT *
FROM EMPLOYEES
NATURAL JOIN DEPARTMENTS;

SELECT COUNT(*)
FROM EMPLOYEES
JOIN DEPARTMENTS
USING (DEPARTMENT_ID);

SELECT COUNT(*)
FROM EMPLOYEES EMP
JOIN DEPARTMENTS DEP
ON EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
WHERE EMP.SALARY > 5000;


SELECT COUNT(*)
FROM EMPLOYEES EMP
LEFT JOIN DEPARTMENTS DEP
ON EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID;

SELECT COUNT(*)
FROM EMPLOYEES EMP
RIGHT JOIN DEPARTMENTS DEP
ON EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID;

