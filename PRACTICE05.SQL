-- MIX PRACTICE 05

-- 문제 01

SELECT CONCAT (FIRST_NAME, CONCAT (' ', LAST_NAME)) AS "이름",
       SALARY AS "연봉",
       DEPARTMENT_NAME AS "부서명"
  FROM EMPLOYEES EMP, DEPARTMENTS DEP
 WHERE     EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
       AND HIRE_DATE = (SELECT MAX (HIRE_DATE) FROM EMPLOYEES);



-- 문제 02

SELECT A.DEPARTMENT_ID AS "사번",
       A.LAST_NAME AS "성",
       ROUND (B.AVG_SALARY) AS "자신 부서 평균 연봉",
       ROUND (A.SALARY) AS "연봉"
  FROM EMPLOYEES A,
       (  SELECT DEPARTMENT_ID, AVG (SALARY) AS AVG_SALARY
            FROM EMPLOYEES
        GROUP BY DEPARTMENT_ID) B
 WHERE A.DEPARTMENT_ID = B.DEPARTMENT_ID AND A.SALARY > B.AVG_SALARY;


-- 문제 03

SELECT A.EMPLOYEE_ID AS "사번",
       CONCAT (A.FIRST_NAME, CONCAT (' ', A.LAST_NAME)) AS "이름",
       JOB_TITLE AS "업무",
       A.SALARY AS "연봉"
  FROM EMPLOYEES A,
       (  SELECT DEPARTMENT_ID, AVG (SALARY)
            FROM EMPLOYEES
        GROUP BY DEPARTMENT_ID
          HAVING AVG (SALARY) =
                    (SELECT MAX (AVG_SALARY)
                       FROM (  SELECT DEPARTMENT_ID,
                                      AVG (SALARY) AS "AVG_SALARY"
                                 FROM EMPLOYEES
                             GROUP BY DEPARTMENT_ID))) B,
       JOBS JOB
 WHERE A.DEPARTMENT_ID = B.DEPARTMENT_ID AND A.JOB_ID = JOB.JOB_ID;

-- 문제 04

  SELECT DEPARTMENT_NAME AS "부서명", AVG (SALARY) AS "연봉"
    FROM EMPLOYEES EMP, DEPARTMENTS DEP
	WHERE EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
GROUP BY DEPARTMENT_NAME
  HAVING AVG (SALARY) =
            (SELECT MAX (AVG_SALARY)
               FROM (  SELECT DEPARTMENT_ID, AVG (SALARY) AS "AVG_SALARY"
                         FROM EMPLOYEES
                     GROUP BY DEPARTMENT_ID));



-- 문제 05

  SELECT LOCATION_ID AS "지역", AVG (SALARY) AS "연봉"
    FROM EMPLOYEES EMP, DEPARTMENTS DEP, LOCATIONS LOC
	WHERE EMP.DEPARTMENT_ID = DEP.DEPARTMENT_ID
	AND DEP.LOCATION_ID = LOC.LOCATION_ID
GROUP BY LOCATION_ID
  HAVING AVG (SALARY) = (SELECT MAX (AVG_SALARY)
               			   FROM (  SELECT DEPARTMENT_ID, AVG (SALARY) AS "AVG_SALARY"
                          			 FROM EMPLOYEES
                     	  		 GROUP BY DEPARTMENT_ID));




-- 문제 06



